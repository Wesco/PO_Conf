Function FileExists(ByVal sPath As String) As Boolean
    'Remove trailing backslash
    If InStr(Len(sPath), sPath, "\") > 0 Then sPath = Left(sPath, Len(sPath) - 1)
    'Check to see if the directory exists and return true/false
    If Dir(sPath, vbDirectory) <> "" Then FileExists = True
End Function

Public Sub GetPONumber(itm As Outlook.MailItem)
    Dim sPOList As String
    Dim PO As String
    Dim Branch As String
    Dim FileNumber As Integer
    Dim Subject As String

    FileNumber = FreeFile
    Subject = itm.Subject
    If InStr(Subject, "FW: ") Then Subject = Replace(Subject, "FW: ", "")
    Branch = Left(Replace(Subject, "WESCO International, Inc. PO #", ""), 4)
    sPOList = "\\br3615gaps\gaps\PO Conf\" & Branch & "-POList.csv"
    PO = Replace(Subject, "WESCO International, Inc. PO #" & Branch & "-", "")

    'Removes FW: from forwarded emails
    If InStr(PO, "FW: ") Then PO = Replace(PO, "FW: ", "")

    On Error Resume Next
    Open sPOList For Append Shared As #FileNumber

    Select Case Err.Number
            'Write the PO number to POList.csv
        Case 0
            Print #FileNumber, PO
            Close FileNumber

        Case Else
            Open "C:\GetPONumber_ErrorLog.csv" For Append Lock Read Write As #FileNumber
            Print #FileNumber, PO & "," & Date & "," & Time & "," & Environ("username") & "," & Err.Number & "," & Err.Description
            Close FileNumber
    End Select

    'Resume Error Checking
    On Error GoTo 0
End Sub