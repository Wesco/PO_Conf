Public Sub GetPONumber(itm As Outlook.MailItem)
    Dim sPOList As String
    Dim PO As String
    Dim FileNumber As Integer

    FileNumber = FreeFile

    If InStr(itm.Subject, "3605-") Then
        PO = Replace(itm.Subject, "WESCO International, Inc. PO #3605-", "")
        sPOList = "\\br3615gaps\gaps\PO Conf\3605-POList.csv"
    End If

    If InStr(itm.Subject, "3615-") Then
        PO = Replace(itm.Subject, "WESCO International, Inc. PO #3615-", "")
        sPOList = "\\br3615gaps\gaps\PO Conf\3615-POList.csv"
    End If

    If InStr(itm.Subject, "3625-") Then
        PO = Replace(itm.Subject, "WESCO International, Inc. PO #3625-", "")
        sPOList = "\\br3615gaps\gaps\PO Conf\3625-POList.csv"
    End If

    'Removes FW: from forwarded emails
    If InStr(PO, "FW: ") Then PO = Replace(PO, "FW: ", "")

    On Error Resume Next
    Open sPOList For Append Shared As #FileNumber

    Select Case Err.Number
            'Write the PO number to POList.csv
        Case 0
            Print #FileNumber, PO
            Close FileNumber

            'If an error occurs write the PO number, Date, Time, User, Err Number, and Err description to a log file
            'and email Tanner Reische the error number and description
        Case Else
            Open "C:\ErrorLog.csv" For Append Lock Read Write As #FileNumber
            Print #FileNumber, PO & "," & Date & "," & Time & "," & Environ("username") & "," & Err.Number & "," & Err.Description
            Close FileNumber
    End Select

    'Resume Error Checking
    On Error GoTo 0
End Sub